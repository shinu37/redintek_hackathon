<!DOCTYPE html>
<html>
  <head>
    <!-- Calling aframe and its environment components -->
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.3.1/dist/aframe-environment-component.min.js"></script>
  </head>
  <body>
    <!-- Creating a scene for the aframe -->
    <a-scene>
        <a-asset-item
          id="loop"
          src="./hallway_modular.glb"
        ></a-asset-item>

        
      <a-entity gltf-model="#loop" scale="0.2 0.2 0.2">
        <!-- Invisible light spheres inside the entity -->
        <a-entity
          light="type: point; color: #FFF; intensity: 0.06"
          position="-2 2 -2"
        ></a-entity>
        <a-entity
          light="type: point; color: #FFF; intensity: 0.06"
          position="2 2 -2"
        ></a-entity>
        <a-entity
          light="type: point; color: #FFF; intensity: 0.06"
          position="-2 2 2"
        ></a-entity>
        <a-entity
          light="type: point; color: #FFF; intensity: 0.06"
          position="2 2 2"
        ></a-entity>
      </a-entity>

      <!-- Creating an environment present and the camera entity -->
      <a-entity environment="preset:starry" position="0 -1 0"></a-entity>

      
      <a-entity id="rig" position="0 0 0">
        <a-entity
        
          camera
          look-controls
          wasd-controls="acceleration:3;"
          position="0 0.3 0"
          rotation="0 0 0"
        >

          <a-entity
            position="0 0 -1"
            text="value: Use WASD keys to move, Q/E to move up/down; align: center"
          ></a-entity>
        </a-entity>
      </a-entity>

      <!-- Interactive entity-->
      <a-entity
    id="rotatingBox"
    gltf-model="https://cdn.glitch.global/a9211039-2a20-477d-8918-1d1ad2702aad/cube3.glb?v=1711399490568"
    position="0 0.5 0"
    scale="0.1 0.1 0.1"
    color="red"
  ></a-entity>
  
    </a-scene>


  <!-- JavaScript functions -->


    <script>
      document.addEventListener("keydown", function (event) {
        const camera = document.querySelector("a-entity[camera]");
        const cameraPosition = camera.getAttribute("position");

        switch (event.code) {
          case "KeyQ":
            camera.setAttribute("position", {
              x: cameraPosition.x,
              y: cameraPosition.y + 0.1,
              z: cameraPosition.z,
            });
            break;
          case "KeyE":
            camera.setAttribute("position", {
              x: cameraPosition.x,
              y: cameraPosition.y - 0.1,
              z: cameraPosition.z,
            });
            break;
        }
      });
      const rotatingBox = document.querySelector("#rotatingBox");
        const card1 = document.querySelector("#card1");
        const card2 = document.querySelector("#card2");
        const dialogBoxCard1 = document.querySelector("#dialogBoxCard1");
        const dialogBoxCard2 = document.querySelector("#dialogBoxCard2");

        let rotationIndex = 0;
        const rotations = [
          { from: "0 0 0", to: "0 90 0" },
          { from: "0 90 0", to: "0 180 0" },
          { from: "0 180 0", to: "0 270 0" },
          { from: "0 270 0", to: "0 0 0" },
        ];

        rotatingBox.addEventListener("click", () => {
          const rotation = rotations[rotationIndex];
          rotatingBox.setAttribute("animation", {
            property: "rotation",
            from: rotation.from,
            to: rotation.to,
            dur: 500,
          });
          rotationIndex = (rotationIndex + 1) % rotations.length;
        });

        card1.addEventListener("click", () => {
          showDialogBox(dialogBoxCard1);
        });

        card2.addEventListener("click", () => {
          showDialogBox(dialogBoxCard2);
        });

        function showDialogBox(dialogBox) {
          dialogBox.setAttribute("visible", true);
          card1.setAttribute("visible", false);
          card2.setAttribute("visible", false);
        }

        dialogBoxCard1.addEventListener("click", () => {
          hideDialogBox();
        });

        dialogBoxCard2.addEventListener("click", () => {
          hideDialogBox();
        });

        function hideDialogBox() {
          dialogBoxCard1.setAttribute("visible", false);
          dialogBoxCard2.setAttribute("visible", false);
          card1.setAttribute("visible", true);
          card2.setAttribute("visible", true);
        }
        
        

  
  
 
  const book = document.querySelector("#book");
const cover = document.querySelector("#cover");
const pages = Array.from(book.querySelectorAll("a-plane:not(#cover)"));
let currentPageIndex = 0;

function showPage(index) {
  pages.forEach((page, i) => {
    page.setAttribute("visible", i === index);
  });
}

function switchPage() {
  currentPageIndex = (currentPageIndex + 1) % pages.length;
  showPage(currentPageIndex);

  if (currentPageIndex === 0) {
    cover.setAttribute("visible", true);
  } else {
    cover.setAttribute("visible", false);
  }
}

cover.addEventListener("click", switchPage);

pages.forEach(page => {
  page.addEventListener("click", switchPage);
});
    </script>
  </body>
</html>
